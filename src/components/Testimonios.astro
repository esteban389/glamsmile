<section class="testimonials" aria-labelledby="testimonials-title">
	<div class="container">
		<div class="testimonials-header">
			<h2 id="testimonials-title">Lo que dicen nuestros pacientes</h2>
		</div>

		<div class="testimonials-slider">
			<div class="testimonial-cards">
				<article class="testimonial-card active">
					<div class="testimonial-content">
						<blockquote>
							<p class="quote">
								"No puedo dejar de sonre√≠r, el cambio fue incre√≠ble. El proceso fue r√°pido y sin dolor. ¬°Gracias Glam Smile!"
							</p>
						</blockquote>
						<div class="rating" aria-label="Calificaci√≥n: 5 de 5 estrellas">
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
						</div>
					</div>
					<div class="patient-info">
						<div class="patient-avatar">
							<img src="/assets/girl.jpg" alt="Mar√≠a Garc√≠a" loading="lazy" width="80" height="80" />
						</div>
						<div class="patient-details">
							<h3 class="patient-name">Mar√≠a Garc√≠a</h3>
							<p class="patient-location">üìç Colombia</p>
						</div>
					</div>
				</article>

				<article class="testimonial-card">
					<div class="testimonial-content">
						<blockquote>
							<p class="quote">
								"Viaje desde Panam√° y en solo 48 horas ten√≠a la sonrisa que siempre so√±√©. Excelente atenci√≥n y resultado natural."
							</p>
						</blockquote>
						<div class="rating" aria-label="Calificaci√≥n: 5 de 5 estrellas">
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
						</div>
					</div>
					<div class="patient-info">
						<div class="patient-avatar">
							<img src="/assets/guy.jpg" alt="Carlos Rodr√≠guez" loading="lazy" width="80" height="80" />
						</div>
						<div class="patient-details">
							<h3 class="patient-name">Carlos Rodr√≠guez</h3>
							<p class="patient-location">üìç Panam√°</p>
						</div>
					</div>
				</article>

				<article class="testimonial-card">
					<div class="testimonial-content">
						<blockquote>
							<p class="quote">
								"Profesionales de verdad. Me sent√≠ acompa√±ado en todo momento, incluso despu√©s del tratamiento."
							</p>
						</blockquote>
						<div class="rating" aria-label="Calificaci√≥n: 5 de 5 estrellas">
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
							<span class="star">‚≠ê</span>
						</div>
					</div>
					<div class="patient-info">
						<div class="patient-avatar">
							<img src="/assets/girl.jpg" alt="Ana Mart√≠nez" loading="lazy" width="80" height="80" />
						</div>
						<div class="patient-details">
							<h3 class="patient-name">Ana Mart√≠nez</h3>
							<p class="patient-location">üìç Ecuador</p>
						</div>
					</div>
				</article>
			</div>

			<div class="slider-controls">
				<button class="slider-btn prev" aria-label="Testimonio anterior" disabled>
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polyline points="15 18 9 12 15 6"></polyline>
					</svg>
				</button>

				<div class="slider-dots">
					<button class="dot active" aria-label="Ir al testimonio 1" aria-current="true"></button>
					<button class="dot" aria-label="Ir al testimonio 2"></button>
					<button class="dot" aria-label="Ir al testimonio 3"></button>
				</div>

				<button class="slider-btn next" aria-label="Siguiente testimonio">
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polyline points="9 18 15 12 9 6"></polyline>
					</svg>
				</button>
			</div>
		</div>
	</div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
	const testimonialCards = document.querySelectorAll('.testimonial-card');
	const prevBtn = document.querySelector('.slider-btn.prev');
	const nextBtn = document.querySelector('.slider-btn.next');
	const dots = document.querySelectorAll('.dot');

	let currentIndex = 0;
	const totalCards = testimonialCards.length;

	function showTestimonial(index) {
		// Remove active class from all cards and dots
		testimonialCards.forEach(card => card.classList.remove('active'));
		dots.forEach(dot => {
			dot.classList.remove('active');
			dot.removeAttribute('aria-current');
		});

		// Add active class to current card and dot
		testimonialCards[index].classList.add('active');
		dots[index].classList.add('active');
		dots[index].setAttribute('aria-current', 'true');

		// Update button states
		prevBtn.disabled = index === 0;
		nextBtn.disabled = index === totalCards - 1;

		currentIndex = index;
	}

	function nextTestimonial() {
		if (currentIndex < totalCards - 1) {
			showTestimonial(currentIndex + 1);
		}
	}

	function prevTestimonial() {
		if (currentIndex > 0) {
			showTestimonial(currentIndex - 1);
		}
	}

	// Event listeners
	nextBtn.addEventListener('click', nextTestimonial);
	prevBtn.addEventListener('click', prevTestimonial);

	dots.forEach((dot, index) => {
		dot.addEventListener('click', () => showTestimonial(index));
	});

	// Auto-play functionality (optional)
	let autoPlayInterval = setInterval(nextTestimonial, 5000);

	// Pause auto-play on user interaction
	const sliderContainer = document.querySelector('.testimonials-slider');
	sliderContainer.addEventListener('mouseenter', () => {
		clearInterval(autoPlayInterval);
	});

	sliderContainer.addEventListener('mouseleave', () => {
		autoPlayInterval = setInterval(nextTestimonial, 5000);
	});
});
</script>

<style>
	.testimonials {
		padding: clamp(60px, 8vw, 100px) 20px;
		background: var(--color-surface);
		position: relative;
	}

	.testimonials-header {
		text-align: center;
		margin-bottom: 50px;
	}

	.testimonials-header h2 {
		font-size: clamp(32px, 4vw, 48px);
		font-weight: var(--font-weight-bold);
		margin: 0;
		color: var(--color-text);
	}

	.testimonials-slider {
		max-width: 900px;
		margin: 0 auto;
		position: relative;
	}

	.testimonial-cards {
		position: relative;
		height: 320px;
		overflow: hidden;
	}

	.testimonial-card {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		opacity: 0;
		transform: translateX(100%);
		transition: all 0.5s ease;
		pointer-events: none;
	}

	.testimonial-card.active {
		opacity: 1;
		transform: translateX(0);
		pointer-events: auto;
	}

	.testimonial-content {
		background: var(--why-surface);
		border-radius: 16px;
		padding: 40px;
		margin-bottom: 25px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.1);
	}

	.quote {
		font-size: 18px;
		line-height: 1.6;
		color: var(--why-text);
		margin: 0 0 20px;
		font-style: italic;
		position: relative;
	}

	.quote::before {
		content: '"';
		font-size: 60px;
		color: var(--why-accent);
		opacity: 0.3;
		position: absolute;
		top: -20px;
		left: -10px;
		font-family: Georgia, serif;
	}

	.rating {
		display: flex;
		gap: 4px;
		margin-top: 15px;
	}

	.star {
		font-size: 20px;
		color: #FFD700;
	}

	.patient-info {
		display: flex;
		align-items: center;
		gap: 15px;
	}

	.patient-avatar {
		width: 80px;
		height: 80px;
		border-radius: 50%;
		overflow: hidden;
		border: 3px solid var(--why-accent);
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	}

	.patient-avatar img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.patient-details {
		flex: 1;
	}

	.patient-name {
		font-size: 18px;
		font-weight: var(--font-weight-semibold);
		margin: 0 0 5px;
		color: var(--color-text);
	}

	.patient-location {
		font-size: 14px;
		color: var(--color-muted);
		margin: 0;
	}

	.slider-controls {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 20px;
		margin-top: 30px;
	}

	.slider-btn {
		background: rgba(255, 255, 255, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.2);
		color: var(--color-text);
		border-radius: 50%;
		width: 40px;
		height: 40px;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.slider-btn:hover:not(:disabled) {
		background: var(--color-accent);
		color: var(--color-accent-contrast);
		border-color: var(--color-accent);
	}

	.slider-btn:disabled {
		opacity: 0.3;
		cursor: not-allowed;
	}

	.slider-btn:focus {
		outline: 2px solid var(--color-focus);
		outline-offset: 2px;
	}

	.slider-dots {
		display: flex;
		gap: 8px;
	}

	.dot {
		width: 10px;
		height: 10px;
		border-radius: 50%;
		background: rgba(255, 255, 255, 0.3);
		border: none;
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.dot.active {
		background: var(--color-accent);
		transform: scale(1.2);
	}

	.dot:focus {
		outline: 2px solid var(--color-focus);
		outline-offset: 2px;
	}

	/* Responsive adjustments */
	@media (max-width: 768px) {
		.testimonials {
			padding: 50px 20px;
		}

		.testimonials-header {
			margin-bottom: 40px;
		}

		.testimonial-cards {
			height: 380px;
		}

		.testimonial-content {
			padding: 30px 25px;
		}

		.quote {
			font-size: 16px;
		}

		.patient-avatar {
			width: 60px;
			height: 60px;
		}

		.patient-name {
			font-size: 16px;
		}

		.patient-location {
			font-size: 13px;
		}

		.slider-controls {
			gap: 15px;
		}

		.slider-btn {
			width: 35px;
			height: 35px;
		}
	}

	@media (max-width: 480px) {
		.testimonial-cards {
			height: 420px;
		}

		.testimonial-content {
			padding: 25px 20px;
		}

		.quote {
			font-size: 15px;
		}

		.quote::before {
			font-size: 40px;
			top: -15px;
			left: -5px;
		}

		.star {
			font-size: 16px;
		}

		.slider-btn {
			width: 30px;
			height: 30px;
		}

		.dot {
			width: 8px;
			height: 8px;
		}
	}

	/* Performance optimization */
	@media (prefers-reduced-motion: reduce) {
		.testimonial-card {
			transition: none;
		}

		.testimonial-cards {
			transition: none;
		}

		.slider-btn {
			transition: none;
		}

		.dot {
			transition: none;
		}
	}
</style>